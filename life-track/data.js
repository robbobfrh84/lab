var _DATA = {}

var _FALLBACK_DATA = {"home":{"testy":"WE GOT OUR JSON!","array":["How","are","you?"]},"page2":{"athing":"something","testy":"'Sup Earthlings???","feet":["5","3","4","12"]},"add":["test note","Another Note"]}

var _PERSONAL_URI = 'https://api.myjson.com/bins/190b55'; //AFTER CREATING a new URI, past uir here...
var myJsonUrl = 'https://api.myjson.com/bins';
var json;

//This function will take an object, convert it into a string, and create a NEW Json from MyJson.com
postMyJson = function(obj){
  var xhr = new XMLHttpRequest();
  xhr.open("POST", myJsonUrl, true);
  xhr.setRequestHeader("Content-type", "application/json");
  xhr.onreadystatechange = function () {
      if (xhr.readyState == 4) {
          var returnData = JSON.parse(xhr.responseText);
          console.log('New _PERSONAL_URI: ', returnData.uri, 'New Created JSON Object: ', obj);
      }
  }
  xhr.send(obj);
}

getMyJson = function(uri){
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
      json = JSON.stringify(xhr.responseText);
      apiCallback(JSON.parse(xhr.responseText), uri);
    }
  }
  xhr.open('GET', uri, true);
  xhr.send(null);
}

putMyJson = function(data, uri){
  var xhr = new XMLHttpRequest();
  xhr.open('PUT', uri);
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onload = function() {
    if (xhr.status === 200) {
      var json = JSON.stringify(xhr.responseText)
      console.log('NEW API: ', data)
    }
  }
  xhr.send(JSON.stringify(data))
}

apiCallback = function(data, uri){
  _DATA = data
  for (const component of _COMPONENTS_STORED_GLOBALLY) {
    if (component.hasAttribute('serve')) {
      const serve = component.getAttribute('serve')
      // console.log(getDir(_DATA, serve))
      component.setAttribute('served', JSON.stringify(getDir(_DATA, serve)))
    }
  }
}

getDir = (Obj, jVar, shell = {})=>{
  if (jVar.split(/[\.\[\]\"]/)) {
    shell[jVar.split(/[\.\[\]\"]/)[0]] = Obj
    console.log('shell: ',shell)
    for (const p of jVar.split(/[\.\[\]\"]/).filter(Boolean)) {
      shell = Obj[p]
    }
  }
  return Obj = shell ? shell : Obj
}

// postMyJson(JSON.stringify(_FALLBACK_DATA));
getMyJson(_PERSONAL_URI)

/* ----  SAVE good testuse for slow internet ----*/
// setTimeout(()=>{ getMyJson(_PERSONAL_URI) }, 5000)




// _GET_RUN_1_DATA = ()=>{
//   return {"gpx":{"xmlns":"http://www.topografix.com/GPX/1/1","version":"1.1","creator":"Minimalist GPS Tracker","trk":{"name":"June 25, 2017 at 9:48:04 AM PDT","trkseg":{"trkpt":[{"-lat":"30.278436","-lon":"-97.718176","ele":"173.984863","time":"2017-06-25T16:48:06Z"},{"-lat":"30.278480","-lon":"-97.718228","ele":"165.617615","time":"2017-06-25T16:48:18Z"},{"-lat":"30.278301","-lon":"-97.718179","ele":"161.067932","time":"2017-06-25T16:48:45Z"},{"-lat":"30.278289","-lon":"-97.718160","ele":"160.048462","time":"2017-06-25T16:48:48Z"},{"-lat":"30.278257","-lon":"-97.718024","ele":"159.757385","time":"2017-06-25T16:49:05Z"},{"-lat":"30.278251","-lon":"-97.718031","ele":"159.402649","time":"2017-06-25T16:49:06Z"},{"-lat":"30.278198","-lon":"-97.717823","ele":"160.248413","time":"2017-06-25T16:49:24Z"},{"-lat":"30.278202","-lon":"-97.717608","ele":"160.502625","time":"2017-06-25T16:49:42Z"},{"-lat":"30.278229","-lon":"-97.717393","ele":"160.199097","time":"2017-06-25T16:50:00Z"},{"-lat":"30.278264","-lon":"-97.717178","ele":"161.146057","time":"2017-06-25T16:50:12Z"},{"-lat":"30.278353","-lon":"-97.716994","ele":"162.410278","time":"2017-06-25T16:50:24Z"},{"-lat":"30.278537","-lon":"-97.716997","ele":"159.771973","time":"2017-06-25T16:50:54Z"},{"-lat":"30.278728","-lon":"-97.717021","ele":"160.942139","time":"2017-06-25T16:51:09Z"},{"-lat":"30.278908","-lon":"-97.717057","ele":"161.729492","time":"2017-06-25T16:51:20Z"},{"-lat":"30.279086","-lon":"-97.717102","ele":"163.097595","time":"2017-06-25T16:51:35Z"},{"-lat":"30.279255","-lon":"-97.717185","ele":"162.046387","time":"2017-06-25T16:51:49Z"},{"-lat":"30.279441","-lon":"-97.717224","ele":"163.197510","time":"2017-06-25T16:52:03Z"},{"-lat":"30.279638","-lon":"-97.717239","ele":"163.873535","time":"2017-06-25T16:52:18Z"},{"-lat":"30.279821","-lon":"-97.717294","ele":"167.061951","time":"2017-06-25T16:52:32Z"},{"-lat":"30.280000","-lon":"-97.717358","ele":"167.494385","time":"2017-06-25T16:52:48Z"},{"-lat":"30.280190","-lon":"-97.717370","ele":"169.658081","time":"2017-06-25T16:52:59Z"},{"-lat":"30.280370","-lon":"-97.717425","ele":"171.145813","time":"2017-06-25T16:53:15Z"},{"-lat":"30.280357","-lon":"-97.717639","ele":"169.452393","time":"2017-06-25T16:53:28Z"},{"-lat":"30.280325","-lon":"-97.717861","ele":"171.712402","time":"2017-06-25T16:53:39Z"},{"-lat":"30.280277","-lon":"-97.718077","ele":"173.906433","time":"2017-06-25T16:53:53Z"},{"-lat":"30.280245","-lon":"-97.718291","ele":"174.904663","time":"2017-06-25T16:54:05Z"},{"-lat":"30.280206","-lon":"-97.718508","ele":"172.257751","time":"2017-06-25T16:54:18Z"},{"-lat":"30.280159","-lon":"-97.718725","ele":"170.528503","time":"2017-06-25T16:54:27Z"},{"-lat":"30.280144","-lon":"-97.718940","ele":"170.717896","time":"2017-06-25T16:54:35Z"},{"-lat":"30.280086","-lon":"-97.719141","ele":"170.400696","time":"2017-06-25T16:54:45Z"},{"-lat":"30.280021","-lon":"-97.719346","ele":"169.563721","time":"2017-06-25T16:54:55Z"},{"-lat":"30.279992","-lon":"-97.719567","ele":"168.111084","time":"2017-06-25T16:55:04Z"},{"-lat":"30.279948","-lon":"-97.719780","ele":"168.382446","time":"2017-06-25T16:55:13Z"},{"-lat":"30.279920","-lon":"-97.720000","ele":"168.387512","time":"2017-06-25T16:55:23Z"},{"-lat":"30.279896","-lon":"-97.720225","ele":"167.764465","time":"2017-06-25T16:55:33Z"},{"-lat":"30.279865","-lon":"-97.720451","ele":"169.185303","time":"2017-06-25T16:55:44Z"},{"-lat":"30.279806","-lon":"-97.720649","ele":"169.780396","time":"2017-06-25T16:55:58Z"},{"-lat":"30.279766","-lon":"-97.720864","ele":"173.154297","time":"2017-06-25T16:56:10Z"},{"-lat":"30.279801","-lon":"-97.721089","ele":"174.757629","time":"2017-06-25T16:56:19Z"},{"-lat":"30.279745","-lon":"-97.721299","ele":"174.230164","time":"2017-06-25T16:56:33Z"},{"-lat":"30.279725","-lon":"-97.721517","ele":"172.345581","time":"2017-06-25T16:56:45Z"},{"-lat":"30.279694","-lon":"-97.721735","ele":"173.265259","time":"2017-06-25T16:56:58Z"},{"-lat":"30.279664","-lon":"-97.721962","ele":"172.175354","time":"2017-06-25T16:57:10Z"},{"-lat":"30.279577","-lon":"-97.722164","ele":"172.479248","time":"2017-06-25T16:57:19Z"},{"-lat":"30.279537","-lon":"-97.722388","ele":"174.980591","time":"2017-06-25T16:57:29Z"},{"-lat":"30.279528","-lon":"-97.722611","ele":"174.580017","time":"2017-06-25T16:57:39Z"},{"-lat":"30.279467","-lon":"-97.722823","ele":"176.549438","time":"2017-06-25T16:57:51Z"},{"-lat":"30.279431","-lon":"-97.723027","ele":"175.864624","time":"2017-06-25T16:58:00Z"},{"-lat":"30.279356","-lon":"-97.723239","ele":"174.081421","time":"2017-06-25T16:58:10Z"},{"-lat":"30.279328","-lon":"-97.723469","ele":"174.302979","time":"2017-06-25T16:58:19Z"},{"-lat":"30.279254","-lon":"-97.723684","ele":"175.309753","time":"2017-06-25T16:58:27Z"},{"-lat":"30.279243","-lon":"-97.723902","ele":"177.695190","time":"2017-06-25T16:58:36Z"},{"-lat":"30.279202","-lon":"-97.724112","ele":"176.965271","time":"2017-06-25T16:58:44Z"},{"-lat":"30.279184","-lon":"-97.724327","ele":"177.818298","time":"2017-06-25T16:58:54Z"},{"-lat":"30.279065","-lon":"-97.724501","ele":"176.133728","time":"2017-06-25T16:59:04Z"},{"-lat":"30.279070","-lon":"-97.724733","ele":"175.125122","time":"2017-06-25T16:59:13Z"},{"-lat":"30.279106","-lon":"-97.724948","ele":"175.953247","time":"2017-06-25T16:59:20Z"},{"-lat":"30.279041","-lon":"-97.725155","ele":"177.439636","time":"2017-06-25T16:59:33Z"},{"-lat":"30.279008","-lon":"-97.725382","ele":"178.152039","time":"2017-06-25T16:59:43Z"},{"-lat":"30.278944","-lon":"-97.725584","ele":"179.536926","time":"2017-06-25T16:59:50Z"},{"-lat":"30.278943","-lon":"-97.725794","ele":"179.150208","time":"2017-06-25T17:00:07Z"},{"-lat":"30.278902","-lon":"-97.725998","ele":"179.076904","time":"2017-06-25T17:00:44Z"},{"-lat":"30.278898","-lon":"-97.726215","ele":"178.637634","time":"2017-06-25T17:00:57Z"},{"-lat":"30.278882","-lon":"-97.726438","ele":"180.192505","time":"2017-06-25T17:01:07Z"},{"-lat":"30.278824","-lon":"-97.726650","ele":"179.090027","time":"2017-06-25T17:01:17Z"},{"-lat":"30.278783","-lon":"-97.726857","ele":"176.591614","time":"2017-06-25T17:01:27Z"},{"-lat":"30.278763","-lon":"-97.727071","ele":"173.773438","time":"2017-06-25T17:01:36Z"},{"-lat":"30.278755","-lon":"-97.727288","ele":"175.309814","time":"2017-06-25T17:01:44Z"},{"-lat":"30.278741","-lon":"-97.727499","ele":"174.141602","time":"2017-06-25T17:01:53Z"},{"-lat":"30.278684","-lon":"-97.727709","ele":"176.109436","time":"2017-06-25T17:02:02Z"},{"-lat":"30.278667","-lon":"-97.727936","ele":"177.365173","time":"2017-06-25T17:02:10Z"},{"-lat":"30.278651","-lon":"-97.728149","ele":"176.792114","time":"2017-06-25T17:02:19Z"},{"-lat":"30.278639","-lon":"-97.728366","ele":"176.453857","time":"2017-06-25T17:02:32Z"},{"-lat":"30.278576","-lon":"-97.728572","ele":"177.575073","time":"2017-06-25T17:02:39Z"},{"-lat":"30.278511","-lon":"-97.728796","ele":"177.760925","time":"2017-06-25T17:02:46Z"},{"-lat":"30.278434","-lon":"-97.728988","ele":"176.308655","time":"2017-06-25T17:03:03Z"},{"-lat":"30.278456","-lon":"-97.729209","ele":"173.801514","time":"2017-06-25T17:03:23Z"},{"-lat":"30.278434","-lon":"-97.729439","ele":"173.963501","time":"2017-06-25T17:03:31Z"},{"-lat":"30.278407","-lon":"-97.729650","ele":"172.839172","time":"2017-06-25T17:03:39Z"},{"-lat":"30.278404","-lon":"-97.729875","ele":"172.154907","time":"2017-06-25T17:03:48Z"},{"-lat":"30.278406","-lon":"-97.730091","ele":"171.770569","time":"2017-06-25T17:03:56Z"},{"-lat":"30.278436","-lon":"-97.730327","ele":"171.117859","time":"2017-06-25T17:04:04Z"},{"-lat":"30.278484","-lon":"-97.730538","ele":"169.590576","time":"2017-06-25T17:04:14Z"},{"-lat":"30.278510","-lon":"-97.730749","ele":"169.733765","time":"2017-06-25T17:04:22Z"},{"-lat":"30.278605","-lon":"-97.730950","ele":"168.271240","time":"2017-06-25T17:04:31Z"},{"-lat":"30.278663","-lon":"-97.731160","ele":"166.737610","time":"2017-06-25T17:04:38Z"},{"-lat":"30.278702","-lon":"-97.731378","ele":"166.526489","time":"2017-06-25T17:04:44Z"},{"-lat":"30.278769","-lon":"-97.731586","ele":"167.838806","time":"2017-06-25T17:04:52Z"},{"-lat":"30.278819","-lon":"-97.731788","ele":"169.619934","time":"2017-06-25T17:05:00Z"},{"-lat":"30.278847","-lon":"-97.731998","ele":"166.486450","time":"2017-06-25T17:05:11Z"},{"-lat":"30.278898","-lon":"-97.732210","ele":"163.540161","time":"2017-06-25T17:05:30Z"},{"-lat":"30.278969","-lon":"-97.732404","ele":"160.244629","time":"2017-06-25T17:05:37Z"},{"-lat":"30.279135","-lon":"-97.732283","ele":"163.992737","time":"2017-06-25T17:07:03Z"},{"-lat":"30.279208","-lon":"-97.732474","ele":"160.612305","time":"2017-06-25T17:07:17Z"},{"-lat":"30.279150","-lon":"-97.732713","ele":"158.159424","time":"2017-06-25T17:07:25Z"},{"-lat":"30.279252","-lon":"-97.732907","ele":"157.052979","time":"2017-06-25T17:07:32Z"},{"-lat":"30.279365","-lon":"-97.733095","ele":"154.838684","time":"2017-06-25T17:07:43Z"},{"-lat":"30.279420","-lon":"-97.733319","ele":"154.819214","time":"2017-06-25T17:07:51Z"},{"-lat":"30.279484","-lon":"-97.733526","ele":"154.527649","time":"2017-06-25T17:07:58Z"},{"-lat":"30.279526","-lon":"-97.733755","ele":"153.437195","time":"2017-06-25T17:08:04Z"},{"-lat":"30.279631","-lon":"-97.733949","ele":"152.562317","time":"2017-06-25T17:08:16Z"},{"-lat":"30.279687","-lon":"-97.734163","ele":"152.215942","time":"2017-06-25T17:08:24Z"},{"-lat":"30.279754","-lon":"-97.734368","ele":"150.937744","time":"2017-06-25T17:08:44Z"},{"-lat":"30.279798","-lon":"-97.734578","ele":"150.537354","time":"2017-06-25T17:09:01Z"},{"-lat":"30.279848","-lon":"-97.734796","ele":"152.732056","time":"2017-06-25T17:09:08Z"},{"-lat":"30.279910","-lon":"-97.735009","ele":"150.098694","time":"2017-06-25T17:09:18Z"},{"-lat":"30.279952","-lon":"-97.735217","ele":"148.925842","time":"2017-06-25T17:09:25Z"},{"-lat":"30.280021","-lon":"-97.735417","ele":"149.653381","time":"2017-06-25T17:09:35Z"},{"-lat":"30.280196","-lon":"-97.735522","ele":"151.701111","time":"2017-06-25T17:09:43Z"},{"-lat":"30.280365","-lon":"-97.735445","ele":"153.418579","time":"2017-06-25T17:09:52Z"},{"-lat":"30.280502","-lon":"-97.735303","ele":"152.867920","time":"2017-06-25T17:10:02Z"},{"-lat":"30.280583","-lon":"-97.735097","ele":"153.206726","time":"2017-06-25T17:10:11Z"},{"-lat":"30.280607","-lon":"-97.734885","ele":"153.608643","time":"2017-06-25T17:10:22Z"},{"-lat":"30.280652","-lon":"-97.734715","ele":"155.323181","time":"2017-06-25T17:10:34Z"},{"-lat":"30.280770","-lon":"-97.734549","ele":"160.720581","time":"2017-06-25T17:10:50Z"},{"-lat":"30.280836","-lon":"-97.734501","ele":"161.141724","time":"2017-06-25T17:10:56Z"},{"-lat":"30.280955","-lon":"-97.734341","ele":"161.524780","time":"2017-06-25T17:11:07Z"},{"-lat":"30.281107","-lon":"-97.734201","ele":"160.433594","time":"2017-06-25T17:11:17Z"},{"-lat":"30.281263","-lon":"-97.734077","ele":"161.681030","time":"2017-06-25T17:11:27Z"},{"-lat":"30.281419","-lon":"-97.733940","ele":"160.486572","time":"2017-06-25T17:11:38Z"},{"-lat":"30.281610","-lon":"-97.733882","ele":"162.526367","time":"2017-06-25T17:11:48Z"},{"-lat":"30.281786","-lon":"-97.733971","ele":"163.505554","time":"2017-06-25T17:11:57Z"},{"-lat":"30.281792","-lon":"-97.734183","ele":"161.045715","time":"2017-06-25T17:12:08Z"},{"-lat":"30.281752","-lon":"-97.734408","ele":"161.830261","time":"2017-06-25T17:12:17Z"},{"-lat":"30.281794","-lon":"-97.734617","ele":"162.288818","time":"2017-06-25T17:12:26Z"},{"-lat":"30.281745","-lon":"-97.734819","ele":"159.820251","time":"2017-06-25T17:12:39Z"},{"-lat":"30.281564","-lon":"-97.734874","ele":"163.113037","time":"2017-06-25T17:13:04Z"},{"-lat":"30.281416","-lon":"-97.734994","ele":"163.311401","time":"2017-06-25T17:13:12Z"},{"-lat":"30.281272","-lon":"-97.735125","ele":"161.021240","time":"2017-06-25T17:13:20Z"},{"-lat":"30.281128","-lon":"-97.735261","ele":"157.844360","time":"2017-06-25T17:13:28Z"},{"-lat":"30.280951","-lon":"-97.735173","ele":"158.031189","time":"2017-06-25T17:13:34Z"},{"-lat":"30.280755","-lon":"-97.735139","ele":"156.239502","time":"2017-06-25T17:13:43Z"},{"-lat":"30.280625","-lon":"-97.734971","ele":"156.257507","time":"2017-06-25T17:13:50Z"},{"-lat":"30.280641","-lon":"-97.734752","ele":"156.047668","time":"2017-06-25T17:13:57Z"},{"-lat":"30.280746","-lon":"-97.734556","ele":"157.153748","time":"2017-06-25T17:14:05Z"},{"-lat":"30.280852","-lon":"-97.734386","ele":"158.827087","time":"2017-06-25T17:14:13Z"},{"-lat":"30.281012","-lon":"-97.734271","ele":"159.887268","time":"2017-06-25T17:14:30Z"},{"-lat":"30.281117","-lon":"-97.734160","ele":"159.237427","time":"2017-06-25T17:14:43Z"},{"-lat":"30.281283","-lon":"-97.734056","ele":"158.599792","time":"2017-06-25T17:14:59Z"},{"-lat":"30.281432","-lon":"-97.733922","ele":"157.189087","time":"2017-06-25T17:15:12Z"},{"-lat":"30.281608","-lon":"-97.733870","ele":"158.349487","time":"2017-06-25T17:15:22Z"},{"-lat":"30.281716","-lon":"-97.734036","ele":"157.705688","time":"2017-06-25T17:15:35Z"},{"-lat":"30.281770","-lon":"-97.734248","ele":"158.714355","time":"2017-06-25T17:15:42Z"},{"-lat":"30.281826","-lon":"-97.734478","ele":"158.585999","time":"2017-06-25T17:15:49Z"},{"-lat":"30.281760","-lon":"-97.734689","ele":"158.786987","time":"2017-06-25T17:15:59Z"},{"-lat":"30.281597","-lon":"-97.734783","ele":"157.924927","time":"2017-06-25T17:16:06Z"},{"-lat":"30.281437","-lon":"-97.734882","ele":"157.606934","time":"2017-06-25T17:16:13Z"},{"-lat":"30.281265","-lon":"-97.734987","ele":"156.498291","time":"2017-06-25T17:16:20Z"},{"-lat":"30.281125","-lon":"-97.735141","ele":"153.463684","time":"2017-06-25T17:16:29Z"},{"-lat":"30.280966","-lon":"-97.735250","ele":"151.569397","time":"2017-06-25T17:16:38Z"},{"-lat":"30.280771","-lon":"-97.735213","ele":"150.394104","time":"2017-06-25T17:16:46Z"},{"-lat":"30.280625","-lon":"-97.735088","ele":"150.311157","time":"2017-06-25T17:16:54Z"},{"-lat":"30.280595","-lon":"-97.734856","ele":"151.499329","time":"2017-06-25T17:17:00Z"},{"-lat":"30.280704","-lon":"-97.734643","ele":"154.780212","time":"2017-06-25T17:17:07Z"},{"-lat":"30.280798","-lon":"-97.734437","ele":"156.683594","time":"2017-06-25T17:17:14Z"},{"-lat":"30.280963","-lon":"-97.734330","ele":"157.009521","time":"2017-06-25T17:17:24Z"},{"-lat":"30.281000","-lon":"-97.734296","ele":"157.395630","time":"2017-06-25T17:17:29Z"},{"-lat":"30.281134","-lon":"-97.734177","ele":"159.534363","time":"2017-06-25T17:17:45Z"},{"-lat":"30.281266","-lon":"-97.734025","ele":"161.706055","time":"2017-06-25T17:18:01Z"},{"-lat":"30.281299","-lon":"-97.733980","ele":"162.623718","time":"2017-06-25T17:18:05Z"},{"-lat":"30.281311","-lon":"-97.733972","ele":"162.600220","time":"2017-06-25T17:18:06Z"}]}}},"point":[{"elevation":571}]}
// }
